#!/bin/bash

set -e


echo "We are udpating APT to ensure that all your programs that will be installed are the latest official versions"
#updating apt && installing software-properties-common
sudo apt update
#sudo apt install software-properties-common

installVSCode(){
  wget -q0- https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor > microsoft.gpg
  sudo mv microsoft.gpg /etc/apt/trusted.gpg.d/microsoft.gpg

  echo "deb [arch=amd64] https://packages.microsoft.com/repos/vscode stable main" | sudo tee /etc/apt/source.list.d/vscode.list

  sudo apt install code
}

# Declare a list of software to propose for installation
software_list=(
  "firefox"
  "vim"
  "git"
  "python3"
  "netcat"
  "vscode"
  "gummi"
  "anjuta"
  "libreoffice"
  "gcc"
  "g++"
  "vim"
  "apache2"
  "mysql-server"
  "virtualbox"
  "wireshark"
  "default-jdk"
  "notepadqq"
  "koffice" 
  "libreoffice"
  "gnome-documents gnome-calculator gnome-calendar gnome-contacts gnome-characters"
  "gnumeric"
  "libreoffice-calc"
  "subversion" 
  "bind9"
  "default-jre"
  "ufw"
  "iptables -L"
  "ipfilter"
  "doxygen"
  "flex"
  "bison"
  "gcc"
  "anjuta"
  "codeblocks"
  "wxdsgn"

)

# Print a list of the proposed software
echo "The following software is available for installation:"
for app in "${software_list[@]}"; do
  echo "  $app"
done

# Ask the user if they want to install all of the software
read -p "Do you want to install all of the software? (y/n) " response

# If the user says yes, install all of the software
if [[ $response == "y" ]]; then
  for app in "${software_list[@]}"; do
    if [[ $app = "vscode" ]]; then
      installVSCode "@"
    else
      sudo apt install $app
    fi
  done
else
  # If the user says no, let them select the software they want to install
  while true; do
    # Print a list of the software that has not yet been installed
    echo "The following software has not yet been installed:"
    for app in "${software_list[@]}"; do
      if ! dpkg -l | grep -q "^ii $app"; then
        echo "  $app"
      fi
    done

    # Ask the user to select the software they want to install
    read -p "Select the software you want to install (enter a space-separated list): " software

    # Install the selected software
    for app in $software; do
      if [[ $app = "vscode" ]]; then
        installVSCode "@"
      else
        sudo apt install $app
      fi
    done

    # Check if the user wants to install more software
    read -p "Do you want to install more software? (y/n) " response
    if [[ $response != "y" ]]; then
      break
    fi
  done
fi

#Check if the user wants to download Ubuntu Image 
read -p "Do you want to download Ubuntu Image AMD64 ? (y/n) " response
if [[ $response = "y" ]]; then
  VERSION="21.04"
  ARCHITECTURE="amd64"
  URL="http://releases.ubuntu.com/${VERSION}/ubuntu-${VERSION}-desktop-${ARCHITECTURE}.iso"
  DESTINATION="$HOME/Downloads/"

  wget -P "$DESTINATION" "$URL"
  echo "Find your Ubuntu Image ISO to your default Downloads folder"
fi

echo "Thank you for using our package"

exit 0